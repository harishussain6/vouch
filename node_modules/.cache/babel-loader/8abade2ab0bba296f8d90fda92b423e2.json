{"ast":null,"code":"import _slicedToArray from\"D:\\\\Projects\\\\live\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import Avatar from'@material-ui/core/Avatar';import Button from'@material-ui/core/Button';import Icon from'@material-ui/core/Icon';import ListItemIcon from'@material-ui/core/ListItemIcon';import ListItemText from'@material-ui/core/ListItemText';import MenuItem from'@material-ui/core/MenuItem';import Popover from'@material-ui/core/Popover';import Typography from'@material-ui/core/Typography';import*as authActions from'app/auth/store/actions';import React,{useEffect,useState}from'react';import{useDispatch,useSelector}from'react-redux';import{Link,useHistory}from'react-router-dom';import NotificationImportantIcon from'@material-ui/icons/NotificationImportant';import{Badge,IconButton,List,ListItem,withStyles}from'@material-ui/core';import JwtService from'app/services/jwtService';import AssignmentReturnedIcon from'@material-ui/icons/AssignmentReturned';import LiveHelpIcon from'@material-ui/icons/LiveHelp';import VpnKeyIcon from'@material-ui/icons/VpnKey';var StyledBadge=withStyles(function(theme){return{badge:{right:-3,top:13,border:\"2px solid \".concat(theme.palette.background.paper),padding:'0 4px'}};})(Badge);var axios=JwtService.getAxios();function UserMenu(props){var dispatch=useDispatch();var user=useSelector(function(_ref){var auth=_ref.auth;return auth.user;});var _useState=useState(null),_useState2=_slicedToArray(_useState,2),userMenu=_useState2[0],setUserMenu=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),notifications=_useState4[0],setNotifications=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),userNotification=_useState6[0],setUserNotification=_useState6[1];var history=useHistory();useEffect(function(){setInterval(function(){getNotification();},50000);},[]);var userMenuClick=function userMenuClick(event){setUserMenu(event.currentTarget);};function getNotification(){axios.get('/api/admin/notification').then(function(res){var data=res.data.data;setNotifications(data);});}var userMenuClose=function userMenuClose(){setUserMenu(null);};var userMenuNotifcationClick=function userMenuNotifcationClick(event){setUserNotification(event.currentTarget);};var userMenuNotifcationClose=function userMenuNotifcationClose(){setUserNotification(null);};var notificationIcons={AppNotificationsNewTask:/*#__PURE__*/React.createElement(AssignmentReturnedIcon,null),AppNotificationsNewCSR:/*#__PURE__*/React.createElement(LiveHelpIcon,null),AppNotificationsPremiumKeyGeneration:/*#__PURE__*/React.createElement(VpnKeyIcon,null)};var routes={AppNotificationsNewTask:'/tasks',AppNotificationsNewCSR:'/customer_query',AppNotificationsPremiumKeyGeneration:'/premium_key'};function handleNotification(notification){userMenuNotifcationClose();axios.get(\"/api/admin/mark-notification/\".concat(notification.id));history.push(routes[notification.type.replace(/\\\\/g,'')]);}return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(IconButton,{onClick:userMenuNotifcationClick},/*#__PURE__*/React.createElement(StyledBadge,{badgeContent:notifications.filter(function(notification){return!notification.read_at;}).length,color:\"secondary\"},/*#__PURE__*/React.createElement(NotificationImportantIcon,null))),/*#__PURE__*/React.createElement(Popover,{open:Boolean(userNotification),anchorEl:userNotification,onClose:userMenuNotifcationClose,anchorOrigin:{vertical:'bottom',horizontal:'center'},transformOrigin:{vertical:'top',horizontal:'center'}},/*#__PURE__*/React.createElement(List,{dense:true,component:\"nav\"},notifications.length>0?notifications.map(function(notification,index){return/*#__PURE__*/React.createElement(ListItem,{divider:true,key:index,onClick:function onClick(){return handleNotification(notification);}},/*#__PURE__*/React.createElement(ListItemIcon,null,notificationIcons[notification.type.replace(/\\\\/g,'')]),/*#__PURE__*/React.createElement(ListItemText,{primary:notification.data.title}));}):/*#__PURE__*/React.createElement(ListItem,{divider:true},/*#__PURE__*/React.createElement(ListItemText,{primary:\"No notification found\"})))),/*#__PURE__*/React.createElement(Button,{className:\"h-64\",onClick:userMenuClick},user.data.photoURL?/*#__PURE__*/React.createElement(Avatar,{className:\"\",alt:\"user photo\",src:user.data.photoURL}):/*#__PURE__*/React.createElement(Avatar,{className:\"\"},user.data.displayName[0]),/*#__PURE__*/React.createElement(\"div\",{className:\"hidden md:flex flex-col mx-12 items-start\"},/*#__PURE__*/React.createElement(Typography,{component:\"span\",className:\"normal-case font-600 flex\"},user.data.displayName),/*#__PURE__*/React.createElement(Typography,{className:\"text-11 capitalize\",color:\"textSecondary\"},user.role.toString())),/*#__PURE__*/React.createElement(Icon,{className:\"text-16 hidden sm:flex\",variant:\"action\"},\"keyboard_arrow_down\")),/*#__PURE__*/React.createElement(Popover,{open:Boolean(userMenu),anchorEl:userMenu,onClose:userMenuClose,anchorOrigin:{vertical:'bottom',horizontal:'center'},transformOrigin:{vertical:'top',horizontal:'center'},classes:{paper:'py-8'}},/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(MenuItem,{component:Link,to:\"/user/\".concat(user.data.id),onClick:userMenuClose,role:\"button\"},/*#__PURE__*/React.createElement(ListItemIcon,{className:\"min-w-40\"},/*#__PURE__*/React.createElement(Icon,null,\"account_circle\")),/*#__PURE__*/React.createElement(ListItemText,{primary:\"My Profile\"})),/*#__PURE__*/React.createElement(MenuItem,{onClick:function onClick(){dispatch(authActions.logoutUser());userMenuClose();}},/*#__PURE__*/React.createElement(ListItemIcon,{className:\"min-w-40\"},/*#__PURE__*/React.createElement(Icon,null,\"exit_to_app\")),/*#__PURE__*/React.createElement(ListItemText,{primary:\"Logout\"})))));}export default UserMenu;","map":null,"metadata":{},"sourceType":"module"}