{"ast":null,"code":"import _slicedToArray from \"D:\\\\Projects\\\\live\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nimport _objectSpread from \"D:\\\\Projects\\\\live\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nimport _objectWithoutProperties from \"D:\\\\Projects\\\\live\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectWithoutProperties\";\nvar _jsxFileName = \"D:\\\\Projects\\\\live\\\\src\\\\@fuse\\\\core\\\\FuseSearch\\\\FuseSearch.js\";\nimport FuseUtils from '@fuse/utils';\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\nimport Icon from '@material-ui/core/Icon';\nimport IconButton from '@material-ui/core/IconButton';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Paper from '@material-ui/core/Paper';\nimport Popper from '@material-ui/core/Popper';\nimport { makeStyles } from '@material-ui/core/styles';\nimport TextField from '@material-ui/core/TextField';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Typography from '@material-ui/core/Typography';\nimport match from 'autosuggest-highlight/match';\nimport parse from 'autosuggest-highlight/parse';\nimport clsx from 'clsx';\nimport _ from '@lodash';\nimport React, { useEffect, useReducer, useRef } from 'react';\nimport Autosuggest from 'react-autosuggest';\nimport { useSelector } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\n\nfunction renderInputComponent(inputProps) {\n  var variant = inputProps.variant,\n      classes = inputProps.classes,\n      _inputProps$inputRef = inputProps.inputRef,\n      _inputRef = _inputProps$inputRef === void 0 ? function () {} : _inputProps$inputRef,\n      ref = inputProps.ref,\n      other = _objectWithoutProperties(inputProps, [\"variant\", \"classes\", \"inputRef\", \"ref\"]);\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-full relative\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 26,\n      columnNumber: 3\n    }\n  }, variant === 'basic' ?\n  /*#__PURE__*/\n  // Outlined\n  React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(TextField, Object.assign({\n    fullWidth: true,\n    InputProps: {\n      inputRef: function inputRef(node) {\n        ref(node);\n\n        _inputRef(node);\n      },\n      classes: {\n        input: clsx(classes.input, 'py-0 px-16 h-48 ltr:pr-48 rtl:pl-48'),\n        notchedOutline: 'rounded-8'\n      }\n    },\n    variant: \"outlined\"\n  }, other, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 6\n    }\n  })), /*#__PURE__*/React.createElement(Icon, {\n    className: \"absolute top-0 ltr:right-0 rtl:left-0 h-48 w-48 p-12 pointer-events-none\",\n    color: \"action\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 6\n    }\n  }, \"search\")) :\n  /*#__PURE__*/\n  // Standard\n  React.createElement(TextField, Object.assign({\n    fullWidth: true,\n    InputProps: {\n      disableUnderline: true,\n      inputRef: function inputRef(node) {\n        ref(node);\n\n        _inputRef(node);\n      },\n      classes: {\n        input: clsx(classes.input, 'py-0 px-16 h-64')\n      }\n    },\n    variant: \"standard\"\n  }, other, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 5\n    }\n  })));\n}\n\nfunction renderSuggestion(suggestion, _ref) {\n  var _this = this;\n\n  var query = _ref.query,\n      isHighlighted = _ref.isHighlighted;\n  var matches = match(suggestion.title, query);\n  var parts = parse(suggestion.title, matches);\n  return /*#__PURE__*/React.createElement(MenuItem, {\n    selected: isHighlighted,\n    component: \"div\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(ListItemIcon, {\n    className: \"min-w-40\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 4\n    }\n  }, suggestion.icon ? /*#__PURE__*/React.createElement(Icon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 6\n    }\n  }, suggestion.icon) : /*#__PURE__*/React.createElement(\"span\", {\n    className: \"text-20 w-24 font-bold uppercase text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 6\n    }\n  }, suggestion.title[0])), /*#__PURE__*/React.createElement(ListItemText, {\n    primary: parts.map(function (part, index) {\n      return part.highlight ? /*#__PURE__*/React.createElement(\"span\", {\n        key: String(index),\n        style: {\n          fontWeight: 600\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 7\n        }\n      }, part.text) : /*#__PURE__*/React.createElement(\"strong\", {\n        key: String(index),\n        style: {\n          fontWeight: 300\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 7\n        }\n      }, part.text);\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 4\n    }\n  }));\n}\n\nfunction getSuggestions(value, data) {\n  var inputValue = _.deburr(value.trim()).toLowerCase();\n\n  var inputLength = inputValue.length;\n  var count = 0;\n  return inputLength === 0 ? [] : data.filter(function (suggestion) {\n    var keep = count < 10 && match(suggestion.title, inputValue).length > 0;\n\n    if (keep) {\n      count += 1;\n    }\n\n    return keep;\n  });\n}\n\nfunction getSuggestionValue(suggestion) {\n  return suggestion.title;\n}\n\nvar useStyles = makeStyles(function (theme) {\n  return {\n    root: {},\n    container: {\n      position: 'relative'\n    },\n    suggestionsContainerOpen: {\n      position: 'absolute',\n      zIndex: 1,\n      marginTop: theme.spacing(),\n      left: 0,\n      right: 0\n    },\n    suggestion: {\n      display: 'block'\n    },\n    suggestionsList: {\n      margin: 0,\n      padding: 0,\n      listStyleType: 'none'\n    },\n    input: {\n      transition: theme.transitions.create(['background-color'], {\n        easing: theme.transitions.easing.easeInOut,\n        duration: theme.transitions.duration.short\n      }),\n      '&:focus': {\n        backgroundColor: theme.palette.background.paper\n      }\n    }\n  };\n});\nvar initialState = {\n  searchText: '',\n  search: false,\n  navigation: null,\n  suggestions: [],\n  noSuggestions: false\n};\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'open':\n      {\n        return _objectSpread(_objectSpread({}, state), {}, {\n          opened: true\n        });\n      }\n\n    case 'close':\n      {\n        return _objectSpread(_objectSpread({}, state), {}, {\n          opened: false,\n          searchText: ''\n        });\n      }\n\n    case 'setSearchText':\n      {\n        return _objectSpread(_objectSpread({}, state), {}, {\n          searchText: action.value\n        });\n      }\n\n    case 'setNavigation':\n      {\n        return _objectSpread(_objectSpread({}, state), {}, {\n          navigation: action.value\n        });\n      }\n\n    case 'updateSuggestions':\n      {\n        var suggestions = getSuggestions(action.value, state.navigation);\n        var isInputBlank = action.value.trim() === '';\n        var noSuggestions = !isInputBlank && suggestions.length === 0;\n        return _objectSpread(_objectSpread({}, state), {}, {\n          suggestions: suggestions,\n          noSuggestions: noSuggestions\n        });\n      }\n\n    case 'clearSuggestions':\n      {\n        return _objectSpread(_objectSpread({}, state), {}, {\n          suggestions: [],\n          noSuggestions: false\n        });\n      }\n\n    case 'decrement':\n      {\n        return {\n          count: state.count - 1\n        };\n      }\n\n    default:\n      {\n        throw new Error();\n      }\n  }\n}\n\nfunction FuseSearch(props) {\n  var _this2 = this;\n\n  var userRole = useSelector(function (_ref2) {\n    var auth = _ref2.auth;\n    return auth.user.role;\n  });\n  var navigation = useSelector(function (_ref3) {\n    var fuse = _ref3.fuse;\n    return fuse.navigation;\n  });\n\n  var _useReducer = useReducer(reducer, initialState),\n      _useReducer2 = _slicedToArray(_useReducer, 2),\n      state = _useReducer2[0],\n      dispatch = _useReducer2[1];\n\n  var classes = useStyles(props);\n  var suggestionsNode = useRef(null);\n  var popperNode = useRef(null);\n  useEffect(function () {\n    function itemAuthAllowed(item) {\n      return FuseUtils.hasPermission(item.auth, userRole);\n    }\n\n    function setNavigation() {\n      dispatch({\n        type: 'setNavigation',\n        value: FuseUtils.getFlatNavigation(navigation).filter(function (item) {\n          return itemAuthAllowed(item);\n        })\n      });\n    }\n\n    setNavigation();\n  }, [userRole, navigation]);\n\n  function showSearch() {\n    dispatch({\n      type: 'open'\n    });\n    document.addEventListener('keydown', escFunction, false);\n  }\n\n  function hideSearch() {\n    dispatch({\n      type: 'close'\n    });\n    document.removeEventListener('keydown', escFunction, false);\n  }\n\n  function escFunction(event) {\n    if (event.keyCode === 27) {\n      hideSearch();\n    }\n  }\n\n  function handleSuggestionsFetchRequested(_ref4) {\n    var value = _ref4.value;\n    dispatch({\n      type: 'updateSuggestions',\n      value: value\n    });\n  }\n\n  function handleSuggestionSelected(event, _ref5) {\n    var suggestion = _ref5.suggestion;\n    event.preventDefault();\n    event.stopPropagation();\n\n    if (!suggestion.url) {\n      return;\n    }\n\n    props.history.push(suggestion.url);\n    hideSearch();\n  }\n\n  function handleSuggestionsClearRequested() {\n    dispatch({\n      type: 'clearSuggestions'\n    });\n  }\n\n  function handleChange(event) {\n    dispatch({\n      type: 'setSearchText',\n      value: event.target.value\n    });\n  }\n\n  function handleClickAway(event) {\n    return (!suggestionsNode.current || !suggestionsNode.current.contains(event.target)) && hideSearch();\n  }\n\n  var autosuggestProps = {\n    renderInputComponent: renderInputComponent,\n    highlightFirstSuggestion: true,\n    suggestions: state.suggestions,\n    onSuggestionsFetchRequested: handleSuggestionsFetchRequested,\n    onSuggestionsClearRequested: handleSuggestionsClearRequested,\n    onSuggestionSelected: handleSuggestionSelected,\n    getSuggestionValue: getSuggestionValue,\n    renderSuggestion: renderSuggestion\n  };\n\n  switch (props.variant) {\n    case 'basic':\n      {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          className: clsx('flex items-center w-full', props.className),\n          ref: popperNode,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 5\n          }\n        }, /*#__PURE__*/React.createElement(Autosuggest, Object.assign({}, autosuggestProps, {\n          inputProps: {\n            variant: props.variant,\n            classes: classes,\n            placeholder: 'Search',\n            value: state.searchText,\n            onChange: handleChange,\n            onFocus: showSearch,\n            InputLabelProps: {\n              shrink: true\n            },\n            autoFocus: false\n          },\n          theme: {\n            container: 'flex flex-1 w-full',\n            suggestionsList: classes.suggestionsList,\n            suggestion: classes.suggestion\n          },\n          renderSuggestionsContainer: function renderSuggestionsContainer(options) {\n            return /*#__PURE__*/React.createElement(Popper, {\n              anchorEl: popperNode.current,\n              open: Boolean(options.children) || state.noSuggestions,\n              popperOptions: {\n                positionFixed: true\n              },\n              className: \"z-9999\",\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 328,\n                columnNumber: 8\n              }\n            }, /*#__PURE__*/React.createElement(\"div\", {\n              ref: suggestionsNode,\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 334,\n                columnNumber: 9\n              }\n            }, /*#__PURE__*/React.createElement(Paper, Object.assign({\n              elevation: 1,\n              square: true\n            }, options.containerProps, {\n              style: {\n                width: popperNode.current ? popperNode.current.clientWidth : null\n              },\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 335,\n                columnNumber: 10\n              }\n            }), options.children, state.noSuggestions && /*#__PURE__*/React.createElement(Typography, {\n              className: \"px-16 py-12\",\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 343,\n                columnNumber: 12\n              }\n            }, \"No results..\"))));\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 6\n          }\n        })));\n      }\n\n    case 'full':\n      {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          className: clsx(classes.root, 'flex', props.className),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 355,\n            columnNumber: 5\n          }\n        }, /*#__PURE__*/React.createElement(Tooltip, {\n          title: \"Click to search\",\n          placement: \"bottom\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 356,\n            columnNumber: 6\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          onClick: showSearch,\n          onKeyDown: showSearch,\n          role: \"button\",\n          tabIndex: 0,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 357,\n            columnNumber: 7\n          }\n        }, props.trigger)), state.opened && /*#__PURE__*/React.createElement(ClickAwayListener, {\n          onClickAway: handleClickAway,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 363,\n            columnNumber: 7\n          }\n        }, /*#__PURE__*/React.createElement(Paper, {\n          className: \"absolute left-0 right-0 h-full z-9999\",\n          square: true,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 364,\n            columnNumber: 8\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"flex items-center w-full\",\n          ref: popperNode,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 365,\n            columnNumber: 9\n          }\n        }, /*#__PURE__*/React.createElement(Autosuggest, Object.assign({}, autosuggestProps, {\n          inputProps: {\n            classes: classes,\n            placeholder: 'Search',\n            value: state.searchText,\n            onChange: handleChange,\n            InputLabelProps: {\n              shrink: true\n            },\n            autoFocus: true\n          },\n          theme: {\n            container: 'flex flex-1 w-full',\n            suggestionsList: classes.suggestionsList,\n            suggestion: classes.suggestion\n          },\n          renderSuggestionsContainer: function renderSuggestionsContainer(options) {\n            return /*#__PURE__*/React.createElement(Popper, {\n              anchorEl: popperNode.current,\n              open: Boolean(options.children) || state.noSuggestions,\n              popperOptions: {\n                positionFixed: true\n              },\n              className: \"z-9999\",\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 384,\n                columnNumber: 12\n              }\n            }, /*#__PURE__*/React.createElement(\"div\", {\n              ref: suggestionsNode,\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 390,\n                columnNumber: 13\n              }\n            }, /*#__PURE__*/React.createElement(Paper, Object.assign({\n              elevation: 1,\n              square: true\n            }, options.containerProps, {\n              style: {\n                width: popperNode.current ? popperNode.current.clientWidth : null\n              },\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 391,\n                columnNumber: 14\n              }\n            }), options.children, state.noSuggestions && /*#__PURE__*/React.createElement(Typography, {\n              className: \"px-16 py-12\",\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 403,\n                columnNumber: 16\n              }\n            }, \"No results..\"))));\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 366,\n            columnNumber: 10\n          }\n        })), /*#__PURE__*/React.createElement(IconButton, {\n          onClick: hideSearch,\n          className: \"mx-8\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 412,\n            columnNumber: 10\n          }\n        }, /*#__PURE__*/React.createElement(Icon, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 413,\n            columnNumber: 11\n          }\n        }, \"close\"))))));\n      }\n\n    default:\n      {\n        return null;\n      }\n  }\n}\n\nFuseSearch.propTypes = {};\nFuseSearch.defaultProps = {\n  trigger: /*#__PURE__*/React.createElement(IconButton, {\n    className: \"w-64 h-64\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 431,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(Icon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 432,\n      columnNumber: 4\n    }\n  }, \"search\")),\n  variant: 'full' // basic, full\n\n};\nexport default withRouter(React.memo(FuseSearch));","map":{"version":3,"sources":["D:/Projects/live/src/@fuse/core/FuseSearch/FuseSearch.js"],"names":["FuseUtils","ClickAwayListener","Icon","IconButton","ListItemIcon","ListItemText","MenuItem","Paper","Popper","makeStyles","TextField","Tooltip","Typography","match","parse","clsx","_","React","useEffect","useReducer","useRef","Autosuggest","useSelector","withRouter","renderInputComponent","inputProps","variant","classes","inputRef","ref","other","node","input","notchedOutline","disableUnderline","renderSuggestion","suggestion","query","isHighlighted","matches","title","parts","icon","map","part","index","highlight","String","fontWeight","text","getSuggestions","value","data","inputValue","deburr","trim","toLowerCase","inputLength","length","count","filter","keep","getSuggestionValue","useStyles","theme","root","container","position","suggestionsContainerOpen","zIndex","marginTop","spacing","left","right","display","suggestionsList","margin","padding","listStyleType","transition","transitions","create","easing","easeInOut","duration","short","backgroundColor","palette","background","paper","initialState","searchText","search","navigation","suggestions","noSuggestions","reducer","state","action","type","opened","isInputBlank","Error","FuseSearch","props","userRole","auth","user","role","fuse","dispatch","suggestionsNode","popperNode","itemAuthAllowed","item","hasPermission","setNavigation","getFlatNavigation","showSearch","document","addEventListener","escFunction","hideSearch","removeEventListener","event","keyCode","handleSuggestionsFetchRequested","handleSuggestionSelected","preventDefault","stopPropagation","url","history","push","handleSuggestionsClearRequested","handleChange","target","handleClickAway","current","contains","autosuggestProps","highlightFirstSuggestion","onSuggestionsFetchRequested","onSuggestionsClearRequested","onSuggestionSelected","className","placeholder","onChange","onFocus","InputLabelProps","shrink","autoFocus","options","Boolean","children","positionFixed","containerProps","width","clientWidth","trigger","propTypes","defaultProps","memo"],"mappings":"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","sourcesContent":["import FuseUtils from '@fuse/utils';\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\nimport Icon from '@material-ui/core/Icon';\nimport IconButton from '@material-ui/core/IconButton';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Paper from '@material-ui/core/Paper';\nimport Popper from '@material-ui/core/Popper';\nimport { makeStyles } from '@material-ui/core/styles';\nimport TextField from '@material-ui/core/TextField';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Typography from '@material-ui/core/Typography';\nimport match from 'autosuggest-highlight/match';\nimport parse from 'autosuggest-highlight/parse';\nimport clsx from 'clsx';\nimport _ from '@lodash';\nimport React, { useEffect, useReducer, useRef } from 'react';\nimport Autosuggest from 'react-autosuggest';\nimport { useSelector } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\n\nfunction renderInputComponent(inputProps) {\n\tconst { variant, classes, inputRef = () => {}, ref, ...other } = inputProps;\n\treturn (\n\t\t<div className=\"w-full relative\">\n\t\t\t{variant === 'basic' ? (\n\t\t\t\t// Outlined\n\t\t\t\t<>\n\t\t\t\t\t<TextField\n\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\tInputProps={{\n\t\t\t\t\t\t\tinputRef: node => {\n\t\t\t\t\t\t\t\tref(node);\n\t\t\t\t\t\t\t\tinputRef(node);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tclasses: {\n\t\t\t\t\t\t\t\tinput: clsx(classes.input, 'py-0 px-16 h-48 ltr:pr-48 rtl:pl-48'),\n\t\t\t\t\t\t\t\tnotchedOutline: 'rounded-8'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t{...other}\n\t\t\t\t\t/>\n\t\t\t\t\t<Icon\n\t\t\t\t\t\tclassName=\"absolute top-0 ltr:right-0 rtl:left-0 h-48 w-48 p-12 pointer-events-none\"\n\t\t\t\t\t\tcolor=\"action\"\n\t\t\t\t\t>\n\t\t\t\t\t\tsearch\n\t\t\t\t\t</Icon>\n\t\t\t\t</>\n\t\t\t) : (\n\t\t\t\t// Standard\n\t\t\t\t<TextField\n\t\t\t\t\tfullWidth\n\t\t\t\t\tInputProps={{\n\t\t\t\t\t\tdisableUnderline: true,\n\t\t\t\t\t\tinputRef: node => {\n\t\t\t\t\t\t\tref(node);\n\t\t\t\t\t\t\tinputRef(node);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tclasses: {\n\t\t\t\t\t\t\tinput: clsx(classes.input, 'py-0 px-16 h-64')\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t\tvariant=\"standard\"\n\t\t\t\t\t{...other}\n\t\t\t\t/>\n\t\t\t)}\n\t\t</div>\n\t);\n}\n\nfunction renderSuggestion(suggestion, { query, isHighlighted }) {\n\tconst matches = match(suggestion.title, query);\n\tconst parts = parse(suggestion.title, matches);\n\n\treturn (\n\t\t<MenuItem selected={isHighlighted} component=\"div\">\n\t\t\t<ListItemIcon className=\"min-w-40\">\n\t\t\t\t{suggestion.icon ? (\n\t\t\t\t\t<Icon>{suggestion.icon}</Icon>\n\t\t\t\t) : (\n\t\t\t\t\t<span className=\"text-20 w-24 font-bold uppercase text-center\">{suggestion.title[0]}</span>\n\t\t\t\t)}\n\t\t\t</ListItemIcon>\n\t\t\t<ListItemText\n\t\t\t\tprimary={parts.map((part, index) =>\n\t\t\t\t\tpart.highlight ? (\n\t\t\t\t\t\t<span key={String(index)} style={{ fontWeight: 600 }}>\n\t\t\t\t\t\t\t{part.text}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<strong key={String(index)} style={{ fontWeight: 300 }}>\n\t\t\t\t\t\t\t{part.text}\n\t\t\t\t\t\t</strong>\n\t\t\t\t\t)\n\t\t\t\t)}\n\t\t\t/>\n\t\t</MenuItem>\n\t);\n}\n\nfunction getSuggestions(value, data) {\n\tconst inputValue = _.deburr(value.trim()).toLowerCase();\n\tconst inputLength = inputValue.length;\n\tlet count = 0;\n\n\treturn inputLength === 0\n\t\t? []\n\t\t: data.filter(suggestion => {\n\t\t\t\tconst keep = count < 10 && match(suggestion.title, inputValue).length > 0;\n\n\t\t\t\tif (keep) {\n\t\t\t\t\tcount += 1;\n\t\t\t\t}\n\n\t\t\t\treturn keep;\n\t\t  });\n}\n\nfunction getSuggestionValue(suggestion) {\n\treturn suggestion.title;\n}\n\nconst useStyles = makeStyles(theme => ({\n\troot: {},\n\tcontainer: {\n\t\tposition: 'relative'\n\t},\n\tsuggestionsContainerOpen: {\n\t\tposition: 'absolute',\n\t\tzIndex: 1,\n\t\tmarginTop: theme.spacing(),\n\t\tleft: 0,\n\t\tright: 0\n\t},\n\tsuggestion: {\n\t\tdisplay: 'block'\n\t},\n\tsuggestionsList: {\n\t\tmargin: 0,\n\t\tpadding: 0,\n\t\tlistStyleType: 'none'\n\t},\n\tinput: {\n\t\ttransition: theme.transitions.create(['background-color'], {\n\t\t\teasing: theme.transitions.easing.easeInOut,\n\t\t\tduration: theme.transitions.duration.short\n\t\t}),\n\t\t'&:focus': {\n\t\t\tbackgroundColor: theme.palette.background.paper\n\t\t}\n\t}\n}));\n\nconst initialState = {\n\tsearchText: '',\n\tsearch: false,\n\tnavigation: null,\n\tsuggestions: [],\n\tnoSuggestions: false\n};\n\nfunction reducer(state, action) {\n\tswitch (action.type) {\n\t\tcase 'open': {\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\topened: true\n\t\t\t};\n\t\t}\n\t\tcase 'close': {\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\topened: false,\n\t\t\t\tsearchText: ''\n\t\t\t};\n\t\t}\n\t\tcase 'setSearchText': {\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tsearchText: action.value\n\t\t\t};\n\t\t}\n\t\tcase 'setNavigation': {\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tnavigation: action.value\n\t\t\t};\n\t\t}\n\t\tcase 'updateSuggestions': {\n\t\t\tconst suggestions = getSuggestions(action.value, state.navigation);\n\t\t\tconst isInputBlank = action.value.trim() === '';\n\t\t\tconst noSuggestions = !isInputBlank && suggestions.length === 0;\n\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tsuggestions,\n\t\t\t\tnoSuggestions\n\t\t\t};\n\t\t}\n\t\tcase 'clearSuggestions': {\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tsuggestions: [],\n\t\t\t\tnoSuggestions: false\n\t\t\t};\n\t\t}\n\t\tcase 'decrement': {\n\t\t\treturn { count: state.count - 1 };\n\t\t}\n\t\tdefault: {\n\t\t\tthrow new Error();\n\t\t}\n\t}\n}\n\nfunction FuseSearch(props) {\n\tconst userRole = useSelector(({ auth }) => auth.user.role);\n\tconst navigation = useSelector(({ fuse }) => fuse.navigation);\n\n\tconst [state, dispatch] = useReducer(reducer, initialState);\n\tconst classes = useStyles(props);\n\tconst suggestionsNode = useRef(null);\n\tconst popperNode = useRef(null);\n\n\tuseEffect(() => {\n\t\tfunction itemAuthAllowed(item) {\n\t\t\treturn FuseUtils.hasPermission(item.auth, userRole);\n\t\t}\n\n\t\tfunction setNavigation() {\n\t\t\tdispatch({\n\t\t\t\ttype: 'setNavigation',\n\t\t\t\tvalue: FuseUtils.getFlatNavigation(navigation).filter(item => itemAuthAllowed(item))\n\t\t\t});\n\t\t}\n\n\t\tsetNavigation();\n\t}, [userRole, navigation]);\n\n\tfunction showSearch() {\n\t\tdispatch({ type: 'open' });\n\t\tdocument.addEventListener('keydown', escFunction, false);\n\t}\n\n\tfunction hideSearch() {\n\t\tdispatch({ type: 'close' });\n\t\tdocument.removeEventListener('keydown', escFunction, false);\n\t}\n\n\tfunction escFunction(event) {\n\t\tif (event.keyCode === 27) {\n\t\t\thideSearch();\n\t\t}\n\t}\n\n\tfunction handleSuggestionsFetchRequested({ value }) {\n\t\tdispatch({\n\t\t\ttype: 'updateSuggestions',\n\t\t\tvalue\n\t\t});\n\t}\n\n\tfunction handleSuggestionSelected(event, { suggestion }) {\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\tif (!suggestion.url) {\n\t\t\treturn;\n\t\t}\n\t\tprops.history.push(suggestion.url);\n\t\thideSearch();\n\t}\n\n\tfunction handleSuggestionsClearRequested() {\n\t\tdispatch({\n\t\t\ttype: 'clearSuggestions'\n\t\t});\n\t}\n\n\tfunction handleChange(event) {\n\t\tdispatch({\n\t\t\ttype: 'setSearchText',\n\t\t\tvalue: event.target.value\n\t\t});\n\t}\n\n\tfunction handleClickAway(event) {\n\t\treturn (!suggestionsNode.current || !suggestionsNode.current.contains(event.target)) && hideSearch();\n\t}\n\n\tconst autosuggestProps = {\n\t\trenderInputComponent,\n\t\thighlightFirstSuggestion: true,\n\t\tsuggestions: state.suggestions,\n\t\tonSuggestionsFetchRequested: handleSuggestionsFetchRequested,\n\t\tonSuggestionsClearRequested: handleSuggestionsClearRequested,\n\t\tonSuggestionSelected: handleSuggestionSelected,\n\t\tgetSuggestionValue,\n\t\trenderSuggestion\n\t};\n\n\tswitch (props.variant) {\n\t\tcase 'basic': {\n\t\t\treturn (\n\t\t\t\t<div className={clsx('flex items-center w-full', props.className)} ref={popperNode}>\n\t\t\t\t\t<Autosuggest\n\t\t\t\t\t\t{...autosuggestProps}\n\t\t\t\t\t\tinputProps={{\n\t\t\t\t\t\t\tvariant: props.variant,\n\t\t\t\t\t\t\tclasses,\n\t\t\t\t\t\t\tplaceholder: 'Search',\n\t\t\t\t\t\t\tvalue: state.searchText,\n\t\t\t\t\t\t\tonChange: handleChange,\n\t\t\t\t\t\t\tonFocus: showSearch,\n\t\t\t\t\t\t\tInputLabelProps: {\n\t\t\t\t\t\t\t\tshrink: true\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tautoFocus: false\n\t\t\t\t\t\t}}\n\t\t\t\t\t\ttheme={{\n\t\t\t\t\t\t\tcontainer: 'flex flex-1 w-full',\n\t\t\t\t\t\t\tsuggestionsList: classes.suggestionsList,\n\t\t\t\t\t\t\tsuggestion: classes.suggestion\n\t\t\t\t\t\t}}\n\t\t\t\t\t\trenderSuggestionsContainer={options => (\n\t\t\t\t\t\t\t<Popper\n\t\t\t\t\t\t\t\tanchorEl={popperNode.current}\n\t\t\t\t\t\t\t\topen={Boolean(options.children) || state.noSuggestions}\n\t\t\t\t\t\t\t\tpopperOptions={{ positionFixed: true }}\n\t\t\t\t\t\t\t\tclassName=\"z-9999\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div ref={suggestionsNode}>\n\t\t\t\t\t\t\t\t\t<Paper\n\t\t\t\t\t\t\t\t\t\televation={1}\n\t\t\t\t\t\t\t\t\t\tsquare\n\t\t\t\t\t\t\t\t\t\t{...options.containerProps}\n\t\t\t\t\t\t\t\t\t\tstyle={{ width: popperNode.current ? popperNode.current.clientWidth : null }}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{options.children}\n\t\t\t\t\t\t\t\t\t\t{state.noSuggestions && (\n\t\t\t\t\t\t\t\t\t\t\t<Typography className=\"px-16 py-12\">No results..</Typography>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</Paper>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</Popper>\n\t\t\t\t\t\t)}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\t\tcase 'full': {\n\t\t\treturn (\n\t\t\t\t<div className={clsx(classes.root, 'flex', props.className)}>\n\t\t\t\t\t<Tooltip title=\"Click to search\" placement=\"bottom\">\n\t\t\t\t\t\t<div onClick={showSearch} onKeyDown={showSearch} role=\"button\" tabIndex={0}>\n\t\t\t\t\t\t\t{props.trigger}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Tooltip>\n\n\t\t\t\t\t{state.opened && (\n\t\t\t\t\t\t<ClickAwayListener onClickAway={handleClickAway}>\n\t\t\t\t\t\t\t<Paper className=\"absolute left-0 right-0 h-full z-9999\" square>\n\t\t\t\t\t\t\t\t<div className=\"flex items-center w-full\" ref={popperNode}>\n\t\t\t\t\t\t\t\t\t<Autosuggest\n\t\t\t\t\t\t\t\t\t\t{...autosuggestProps}\n\t\t\t\t\t\t\t\t\t\tinputProps={{\n\t\t\t\t\t\t\t\t\t\t\tclasses,\n\t\t\t\t\t\t\t\t\t\t\tplaceholder: 'Search',\n\t\t\t\t\t\t\t\t\t\t\tvalue: state.searchText,\n\t\t\t\t\t\t\t\t\t\t\tonChange: handleChange,\n\t\t\t\t\t\t\t\t\t\t\tInputLabelProps: {\n\t\t\t\t\t\t\t\t\t\t\t\tshrink: true\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\tautoFocus: true\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\ttheme={{\n\t\t\t\t\t\t\t\t\t\t\tcontainer: 'flex flex-1 w-full',\n\t\t\t\t\t\t\t\t\t\t\tsuggestionsList: classes.suggestionsList,\n\t\t\t\t\t\t\t\t\t\t\tsuggestion: classes.suggestion\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\trenderSuggestionsContainer={options => (\n\t\t\t\t\t\t\t\t\t\t\t<Popper\n\t\t\t\t\t\t\t\t\t\t\t\tanchorEl={popperNode.current}\n\t\t\t\t\t\t\t\t\t\t\t\topen={Boolean(options.children) || state.noSuggestions}\n\t\t\t\t\t\t\t\t\t\t\t\tpopperOptions={{ positionFixed: true }}\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"z-9999\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<div ref={suggestionsNode}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Paper\n\t\t\t\t\t\t\t\t\t\t\t\t\t\televation={1}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsquare\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{...options.containerProps}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth: popperNode.current\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? popperNode.current.clientWidth\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{options.children}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{state.noSuggestions && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography className=\"px-16 py-12\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tNo results..\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Paper>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</Popper>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<IconButton onClick={hideSearch} className=\"mx-8\">\n\t\t\t\t\t\t\t\t\t\t<Icon>close</Icon>\n\t\t\t\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</Paper>\n\t\t\t\t\t\t</ClickAwayListener>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\t\tdefault: {\n\t\t\treturn null;\n\t\t}\n\t}\n}\n\nFuseSearch.propTypes = {};\nFuseSearch.defaultProps = {\n\ttrigger: (\n\t\t<IconButton className=\"w-64 h-64\">\n\t\t\t<Icon>search</Icon>\n\t\t</IconButton>\n\t),\n\tvariant: 'full' // basic, full\n};\n\nexport default withRouter(React.memo(FuseSearch));\n"]},"metadata":{},"sourceType":"module"}