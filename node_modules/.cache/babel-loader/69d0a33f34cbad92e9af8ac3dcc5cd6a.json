{"ast":null,"code":"import _slicedToArray from\"D:\\\\Projects\\\\live\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import _objectSpread from\"D:\\\\Projects\\\\live\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _objectWithoutProperties from\"D:\\\\Projects\\\\live\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectWithoutProperties\";import FuseUtils from'@fuse/utils';import ClickAwayListener from'@material-ui/core/ClickAwayListener';import Icon from'@material-ui/core/Icon';import IconButton from'@material-ui/core/IconButton';import ListItemIcon from'@material-ui/core/ListItemIcon';import ListItemText from'@material-ui/core/ListItemText';import MenuItem from'@material-ui/core/MenuItem';import Paper from'@material-ui/core/Paper';import Popper from'@material-ui/core/Popper';import{makeStyles}from'@material-ui/core/styles';import TextField from'@material-ui/core/TextField';import Tooltip from'@material-ui/core/Tooltip';import Typography from'@material-ui/core/Typography';import match from'autosuggest-highlight/match';import parse from'autosuggest-highlight/parse';import clsx from'clsx';import _ from'@lodash';import React,{useEffect,useReducer,useRef}from'react';import Autosuggest from'react-autosuggest';import{useSelector}from'react-redux';import{withRouter}from'react-router-dom';function renderInputComponent(inputProps){var variant=inputProps.variant,classes=inputProps.classes,_inputProps$inputRef=inputProps.inputRef,_inputRef=_inputProps$inputRef===void 0?function(){}:_inputProps$inputRef,ref=inputProps.ref,other=_objectWithoutProperties(inputProps,[\"variant\",\"classes\",\"inputRef\",\"ref\"]);return/*#__PURE__*/React.createElement(\"div\",{className:\"w-full relative\"},variant==='basic'?/*#__PURE__*/ // Outlined\nReact.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(TextField,Object.assign({fullWidth:true,InputProps:{inputRef:function inputRef(node){ref(node);_inputRef(node);},classes:{input:clsx(classes.input,'py-0 px-16 h-48 ltr:pr-48 rtl:pl-48'),notchedOutline:'rounded-8'}},variant:\"outlined\"},other)),/*#__PURE__*/React.createElement(Icon,{className:\"absolute top-0 ltr:right-0 rtl:left-0 h-48 w-48 p-12 pointer-events-none\",color:\"action\"},\"search\")):/*#__PURE__*/ // Standard\nReact.createElement(TextField,Object.assign({fullWidth:true,InputProps:{disableUnderline:true,inputRef:function inputRef(node){ref(node);_inputRef(node);},classes:{input:clsx(classes.input,'py-0 px-16 h-64')}},variant:\"standard\"},other)));}function renderSuggestion(suggestion,_ref){var query=_ref.query,isHighlighted=_ref.isHighlighted;var matches=match(suggestion.title,query);var parts=parse(suggestion.title,matches);return/*#__PURE__*/React.createElement(MenuItem,{selected:isHighlighted,component:\"div\"},/*#__PURE__*/React.createElement(ListItemIcon,{className:\"min-w-40\"},suggestion.icon?/*#__PURE__*/React.createElement(Icon,null,suggestion.icon):/*#__PURE__*/React.createElement(\"span\",{className:\"text-20 w-24 font-bold uppercase text-center\"},suggestion.title[0])),/*#__PURE__*/React.createElement(ListItemText,{primary:parts.map(function(part,index){return part.highlight?/*#__PURE__*/React.createElement(\"span\",{key:String(index),style:{fontWeight:600}},part.text):/*#__PURE__*/React.createElement(\"strong\",{key:String(index),style:{fontWeight:300}},part.text);})}));}function getSuggestions(value,data){var inputValue=_.deburr(value.trim()).toLowerCase();var inputLength=inputValue.length;var count=0;return inputLength===0?[]:data.filter(function(suggestion){var keep=count<10&&match(suggestion.title,inputValue).length>0;if(keep){count+=1;}return keep;});}function getSuggestionValue(suggestion){return suggestion.title;}var useStyles=makeStyles(function(theme){return{root:{},container:{position:'relative'},suggestionsContainerOpen:{position:'absolute',zIndex:1,marginTop:theme.spacing(),left:0,right:0},suggestion:{display:'block'},suggestionsList:{margin:0,padding:0,listStyleType:'none'},input:{transition:theme.transitions.create(['background-color'],{easing:theme.transitions.easing.easeInOut,duration:theme.transitions.duration.short}),'&:focus':{backgroundColor:theme.palette.background.paper}}};});var initialState={searchText:'',search:false,navigation:null,suggestions:[],noSuggestions:false};function reducer(state,action){switch(action.type){case'open':{return _objectSpread(_objectSpread({},state),{},{opened:true});}case'close':{return _objectSpread(_objectSpread({},state),{},{opened:false,searchText:''});}case'setSearchText':{return _objectSpread(_objectSpread({},state),{},{searchText:action.value});}case'setNavigation':{return _objectSpread(_objectSpread({},state),{},{navigation:action.value});}case'updateSuggestions':{var suggestions=getSuggestions(action.value,state.navigation);var isInputBlank=action.value.trim()==='';var noSuggestions=!isInputBlank&&suggestions.length===0;return _objectSpread(_objectSpread({},state),{},{suggestions:suggestions,noSuggestions:noSuggestions});}case'clearSuggestions':{return _objectSpread(_objectSpread({},state),{},{suggestions:[],noSuggestions:false});}case'decrement':{return{count:state.count-1};}default:{throw new Error();}}}function FuseSearch(props){var userRole=useSelector(function(_ref2){var auth=_ref2.auth;return auth.user.role;});var navigation=useSelector(function(_ref3){var fuse=_ref3.fuse;return fuse.navigation;});var _useReducer=useReducer(reducer,initialState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];var classes=useStyles(props);var suggestionsNode=useRef(null);var popperNode=useRef(null);useEffect(function(){function itemAuthAllowed(item){return FuseUtils.hasPermission(item.auth,userRole);}function setNavigation(){dispatch({type:'setNavigation',value:FuseUtils.getFlatNavigation(navigation).filter(function(item){return itemAuthAllowed(item);})});}setNavigation();},[userRole,navigation]);function showSearch(){dispatch({type:'open'});document.addEventListener('keydown',escFunction,false);}function hideSearch(){dispatch({type:'close'});document.removeEventListener('keydown',escFunction,false);}function escFunction(event){if(event.keyCode===27){hideSearch();}}function handleSuggestionsFetchRequested(_ref4){var value=_ref4.value;dispatch({type:'updateSuggestions',value:value});}function handleSuggestionSelected(event,_ref5){var suggestion=_ref5.suggestion;event.preventDefault();event.stopPropagation();if(!suggestion.url){return;}props.history.push(suggestion.url);hideSearch();}function handleSuggestionsClearRequested(){dispatch({type:'clearSuggestions'});}function handleChange(event){dispatch({type:'setSearchText',value:event.target.value});}function handleClickAway(event){return(!suggestionsNode.current||!suggestionsNode.current.contains(event.target))&&hideSearch();}var autosuggestProps={renderInputComponent:renderInputComponent,highlightFirstSuggestion:true,suggestions:state.suggestions,onSuggestionsFetchRequested:handleSuggestionsFetchRequested,onSuggestionsClearRequested:handleSuggestionsClearRequested,onSuggestionSelected:handleSuggestionSelected,getSuggestionValue:getSuggestionValue,renderSuggestion:renderSuggestion};switch(props.variant){case'basic':{return/*#__PURE__*/React.createElement(\"div\",{className:clsx('flex items-center w-full',props.className),ref:popperNode},/*#__PURE__*/React.createElement(Autosuggest,Object.assign({},autosuggestProps,{inputProps:{variant:props.variant,classes:classes,placeholder:'Search',value:state.searchText,onChange:handleChange,onFocus:showSearch,InputLabelProps:{shrink:true},autoFocus:false},theme:{container:'flex flex-1 w-full',suggestionsList:classes.suggestionsList,suggestion:classes.suggestion},renderSuggestionsContainer:function renderSuggestionsContainer(options){return/*#__PURE__*/React.createElement(Popper,{anchorEl:popperNode.current,open:Boolean(options.children)||state.noSuggestions,popperOptions:{positionFixed:true},className:\"z-9999\"},/*#__PURE__*/React.createElement(\"div\",{ref:suggestionsNode},/*#__PURE__*/React.createElement(Paper,Object.assign({elevation:1,square:true},options.containerProps,{style:{width:popperNode.current?popperNode.current.clientWidth:null}}),options.children,state.noSuggestions&&/*#__PURE__*/React.createElement(Typography,{className:\"px-16 py-12\"},\"No results..\"))));}})));}case'full':{return/*#__PURE__*/React.createElement(\"div\",{className:clsx(classes.root,'flex',props.className)},/*#__PURE__*/React.createElement(Tooltip,{title:\"Click to search\",placement:\"bottom\"},/*#__PURE__*/React.createElement(\"div\",{onClick:showSearch,onKeyDown:showSearch,role:\"button\",tabIndex:0},props.trigger)),state.opened&&/*#__PURE__*/React.createElement(ClickAwayListener,{onClickAway:handleClickAway},/*#__PURE__*/React.createElement(Paper,{className:\"absolute left-0 right-0 h-full z-9999\",square:true},/*#__PURE__*/React.createElement(\"div\",{className:\"flex items-center w-full\",ref:popperNode},/*#__PURE__*/React.createElement(Autosuggest,Object.assign({},autosuggestProps,{inputProps:{classes:classes,placeholder:'Search',value:state.searchText,onChange:handleChange,InputLabelProps:{shrink:true},autoFocus:true},theme:{container:'flex flex-1 w-full',suggestionsList:classes.suggestionsList,suggestion:classes.suggestion},renderSuggestionsContainer:function renderSuggestionsContainer(options){return/*#__PURE__*/React.createElement(Popper,{anchorEl:popperNode.current,open:Boolean(options.children)||state.noSuggestions,popperOptions:{positionFixed:true},className:\"z-9999\"},/*#__PURE__*/React.createElement(\"div\",{ref:suggestionsNode},/*#__PURE__*/React.createElement(Paper,Object.assign({elevation:1,square:true},options.containerProps,{style:{width:popperNode.current?popperNode.current.clientWidth:null}}),options.children,state.noSuggestions&&/*#__PURE__*/React.createElement(Typography,{className:\"px-16 py-12\"},\"No results..\"))));}})),/*#__PURE__*/React.createElement(IconButton,{onClick:hideSearch,className:\"mx-8\"},/*#__PURE__*/React.createElement(Icon,null,\"close\"))))));}default:{return null;}}}FuseSearch.defaultProps={trigger:/*#__PURE__*/React.createElement(IconButton,{className:\"w-64 h-64\"},/*#__PURE__*/React.createElement(Icon,null,\"search\")),variant:'full'// basic, full\n};export default withRouter(React.memo(FuseSearch));","map":null,"metadata":{},"sourceType":"module"}