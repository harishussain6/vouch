{"ast":null,"code":"import{useDeepCompareEffect}from'@fuse/hooks';import FuseLayouts from'@fuse/layouts/FuseLayouts';import _ from'@lodash';import{makeStyles}from'@material-ui/core/styles';import AppContext from'app/AppContext';import*as Actions from'app/store/actions';import{generateSettings}from'app/store/reducers/fuse/settings.reducer';import React,{useContext,useMemo,useCallback,useRef}from'react';import{useDispatch,useSelector}from'react-redux';import{matchRoutes}from'react-router-config';import{useLocation}from'react-router-dom';import*as Velocity from'velocity-animate';import{defaults as Chartjs2Defaults}from'react-chartjs-2';var useStyles=makeStyles(function(theme){return{'@global':{'code:not([class*=\"language-\"])':{color:theme.palette.secondary.dark,backgroundColor:theme.palette.type==='light'?'rgba(255, 255, 255, .9)':'rgba(0, 0, 0, .9)',padding:'2px 3px',borderRadius:2,lineHeight:1.7},'table.simple tbody tr td':{borderColor:theme.palette.divider},'table.simple thead tr th':{borderColor:theme.palette.divider},'a:not([role=button])':{color:theme.palette.secondary.main,textDecoration:'none','&:hover':{textDecoration:'underline'}},'[class^=\"border-\"]':{borderColor:theme.palette.divider},'[class*=\"border-\"]':{borderColor:theme.palette.divider},hr:{borderColor:theme.palette.divider}},root:{backgroundColor:theme.palette.background.default,color:theme.palette.text.primary}};});function FuseLayout(props){var dispatch=useDispatch();var settings=useSelector(function(_ref){var fuse=_ref.fuse;return fuse.settings.current;});var defaultSettings=useSelector(function(_ref2){var fuse=_ref2.fuse;return fuse.settings.defaults;});var appContext=useContext(AppContext);var routes=appContext.routes;var classes=useStyles(props);var location=useLocation();var pathname=location.pathname;var matched=matchRoutes(routes,pathname)[0];var newSettings=useRef(null);var shouldAwaitRender=useCallback(function(){var _newSettings;/**\n\t\t * On Path changed\n\t\t */ // if (prevPathname !== pathname) {\nif(matched&&matched.route.settings){/**\n\t\t\t * if matched route has settings\n\t\t\t */var routeSettings=matched.route.settings;_newSettings=generateSettings(defaultSettings,routeSettings);}else if(!_.isEqual(newSettings.current,defaultSettings)){/**\n\t\t\t * Reset to default settings on the new path\n\t\t\t */_newSettings=_.merge({},defaultSettings);}else{_newSettings=newSettings.current;}if(!_.isEqual(newSettings.current,_newSettings)){newSettings.current=_newSettings;}function AnimationToggle(_settings){if(!_settings.animations){document.body.classList.add('no-animate');Velocity.mock=true;Chartjs2Defaults.global.animation.duration=0;Chartjs2Defaults.global.hover.animationDuration=0;}else{document.body.classList.remove('no-animate');Velocity.mock=false;Chartjs2Defaults.global.animation.duration=1000;Chartjs2Defaults.global.hover.animationDuration=400;}}AnimationToggle(_newSettings);},[defaultSettings,matched]);shouldAwaitRender();useDeepCompareEffect(function(){if(!_.isEqual(newSettings.current,settings)){dispatch(Actions.setSettings(newSettings.current));}},[dispatch,newSettings.current,settings]);// console.warn('::FuseLayout:: rendered');\nvar Layout=useMemo(function(){return FuseLayouts[settings.layout.style];},[settings.layout.style]);return _.isEqual(newSettings.current,settings)?/*#__PURE__*/React.createElement(Layout,Object.assign({classes:{root:classes.root}},props)):null;}export default React.memo(FuseLayout);","map":null,"metadata":{},"sourceType":"module"}