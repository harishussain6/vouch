{"ast":null,"code":"import _regeneratorRuntime from \"D:\\\\Projects\\\\live\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"D:\\\\Projects\\\\live\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"D:\\\\Projects\\\\live\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"D:\\\\Projects\\\\live\\\\src\\\\app\\\\main\\\\vendor\\\\Vendors.js\";\nimport React, { useState, useEffect } from 'react';\nimport JwtService from 'app/services/jwtService';\nimport { Grid } from '@material-ui/core';\nimport MaterialTable from 'material-table';\nimport { useHistory } from 'react-router';\nimport FusePageSimple from '@fuse/core/FusePageSimple';\nimport FuseLoading from '@fuse/core/FuseLoading';\nimport { connect } from 'react-redux';\nimport axios from 'axios';\n\nfunction Vendors(_ref) {\n  var _this = this;\n\n  var user = _ref.user;\n  var history = useHistory();\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      selectedOption = _useState2[0],\n      setSelectedOption = _useState2[1]; // Initial selected option\n\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      alldata = _useState4[0],\n      setAlldata = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      data = _useState6[0],\n      setData = _useState6[1];\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      page = _useState8[0],\n      setPage = _useState8[1];\n\n  var _useState9 = useState(10),\n      _useState10 = _slicedToArray(_useState9, 2),\n      pageSize = _useState10[0],\n      setPageSize = _useState10[1];\n\n  var _useState11 = useState(''),\n      _useState12 = _slicedToArray(_useState11, 2),\n      search = _useState12[0],\n      setSearch = _useState12[1];\n\n  var _useState13 = useState([]),\n      _useState14 = _slicedToArray(_useState13, 2),\n      totalCount = _useState14[0],\n      setTotalCount = _useState14[1];\n\n  var _useState15 = useState(false),\n      _useState16 = _slicedToArray(_useState15, 2),\n      loading = _useState16[0],\n      setLoading = _useState16[1];\n\n  function getData() {\n    return new Promise( /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(resolve) {\n        var axios, params, vendors, resp, allparams, allvendors, allresp;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                JwtService.init();\n                axios = JwtService.getAxios();\n                params = {\n                  page: page,\n                  limit: pageSize,\n                  q: search\n                };\n                if (user.data.role === 'vendor') params.parent_id = user.data.xid;else params.parent_id = 0;\n                _context.next = 6;\n                return axios.get('/api/admin/vendor', {\n                  params: params\n                });\n\n              case 6:\n                vendors = _context.sent;\n                resp = vendors.data;\n\n                if (!(alldata == '')) {\n                  _context.next = 15;\n                  break;\n                }\n\n                allparams = {\n                  limit: resp.data.total,\n                  q: '',\n                  parent_id: 0\n                };\n                _context.next = 12;\n                return axios.get('/api/admin/vendor?limit=' + resp.data.total + '&q=&parent_id=0');\n\n              case 12:\n                allvendors = _context.sent;\n                allresp = allvendors.data;\n                setAlldata(allresp.data.data);\n\n              case 15:\n                if (resp.status) {\n                  resolve({\n                    data: resp.data.data,\n                    /// your data array\n                    page: pageSize,\n                    // current page number\n                    totalCount: resp.data.total // total row number\n\n                  });\n                } else {\n                  resolve({\n                    data: [],\n                    /// your data array\n                    page: 0,\n                    // current page number\n                    totalCount: 0 // total row number\n\n                  });\n                }\n\n              case 16:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n  }\n\n  var fetchData = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var result;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              setLoading(true);\n              _context2.next = 4;\n              return getData();\n\n            case 4:\n              result = _context2.sent;\n              // console.log(result.totalCount)\n              setData(result.data);\n              setTotalCount(result.totalCount); // setPage(result.page);\n\n              _context2.next = 12;\n              break;\n\n            case 9:\n              _context2.prev = 9;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.error('Error fetching data:', _context2.t0);\n\n            case 12:\n              _context2.prev = 12;\n              setLoading(false);\n              return _context2.finish(12);\n\n            case 15:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 9, 12, 15]]);\n    }));\n\n    return function fetchData() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    // Define a function to fetch data\n    fetchData(); // Call the fetchData function when selectedOption changes\n  }, [selectedOption, page, pageSize]); //console.log(data)\n\n  function actions() {\n    var actions = [];\n\n    if (['admin', 'it', 'creative', 'alliance'].includes(user.data.role)) {\n      actions.push({\n        icon: 'visibility',\n        tooltip: 'View Vendor',\n        onClick: function onClick(event, data) {\n          return history.push('/vendor/' + data.id + \"/about\");\n        }\n      });\n    }\n\n    return actions;\n  }\n\n  var handleOnChange = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e) {\n      var selectedOption, attributeValue, value, res;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              selectedOption = e.target.options[e.target.selectedIndex];\n              attributeValue = selectedOption.getAttribute('row-id');\n              value = e.target.value;\n              _context3.next = 5;\n              return axios.put(\"/api/admin/vendor/\".concat(attributeValue, \"?status=\").concat(value));\n\n            case 5:\n              res = _context3.sent;\n\n              if (res.data.status) {\n                setSelectedOption(function (prevCount) {\n                  return prevCount + 1;\n                });\n              }\n\n            case 7:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function handleOnChange(_x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var handlePageChange = function handlePageChange(newPage) {\n    setPage(newPage);\n  };\n\n  var handlePageSizeChange = function handlePageSizeChange(newPageSize) {\n    setPageSize(newPageSize);\n    setPage(0); // Reset to the first page when changing page size\n  };\n\n  var handleSearchChange = function handleSearchChange(search) {\n    setSearch(search);\n  };\n\n  if (loading) {\n    return /*#__PURE__*/React.createElement(FuseLoading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 10\n      }\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(FusePageSimple, {\n    content: /*#__PURE__*/React.createElement(Grid, {\n      container: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(Grid, {\n      item: true,\n      md: 12,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 6\n      }\n    }, /*#__PURE__*/React.createElement(MaterialTable, {\n      title: \"Vendors\" // data={{ data: data, totalCount: totalCount, page: page}}\n      ,\n      data: data,\n      page: page,\n      totalCount: totalCount,\n      columns: [{\n        title: 'Name',\n        field: 'name',\n        width: 30\n      }, {\n        title: 'Locality',\n        field: 'locality',\n        width: 30\n      }, {\n        title: 'City',\n        field: 'city.name',\n        width: 10\n      }, {\n        title: 'Status',\n        field: 'status',\n        width: 10\n      }, {\n        title: 'Status',\n        field: 'name',\n        width: 10,\n        render: function render(data) {\n          return /*#__PURE__*/React.createElement(\"select\", {\n            onChange: handleOnChange,\n            id: \"countries\",\n            className: \"bg-gray-50 border border-gray-300 text-gray-900 text-[16px] h-40 rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500\",\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 11\n            }\n          }, /*#__PURE__*/React.createElement(\"option\", {\n            selected: true,\n            disabled: true,\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 163,\n              columnNumber: 12\n            }\n          }, \"Choose a Status\"), /*#__PURE__*/React.createElement(\"option\", Object.assign({\n            value: \"active\",\n            \"row-id\": data.id\n          }, data.status === 'active' ? {\n            selected: true\n          } : {}, {\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 164,\n              columnNumber: 12\n            }\n          }), \"Active\"), /*#__PURE__*/React.createElement(\"option\", Object.assign({\n            value: \"inactive\",\n            \"row-id\": data.id\n          }, data.status === 'inactive' ? {\n            selected: true\n          } : {}, {\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 165,\n              columnNumber: 12\n            }\n          }), \"In-Active\"));\n        }\n      }],\n      actions: actions(),\n      options: {\n        pageSize: pageSize,\n        pageSizeOptions: [10, 20, 50],\n        actionsColumnIndex: -1,\n        searchable: true\n      },\n      onChangePage: handlePageChange,\n      onChangeRowsPerPage: handlePageSizeChange // onSearchChange={handleSearchChange}\n      ,\n      onSearchChange: function onSearchChange(searchText) {\n        var filteredData = alldata.filter(function (item) {\n          return item.name.toLowerCase().includes(searchText.toLowerCase());\n        });\n        setData(filteredData);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 8\n      }\n    }))),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 3\n    }\n  });\n}\n\nfunction mapStateToProps(_ref5) {\n  var auth = _ref5.auth;\n  return {\n    user: auth.user\n  };\n}\n\nexport default connect(mapStateToProps)(Vendors);","map":{"version":3,"sources":["D:/Projects/live/src/app/main/vendor/Vendors.js"],"names":["React","useState","useEffect","JwtService","Grid","MaterialTable","useHistory","FusePageSimple","FuseLoading","connect","axios","Vendors","user","history","selectedOption","setSelectedOption","alldata","setAlldata","data","setData","page","setPage","pageSize","setPageSize","search","setSearch","totalCount","setTotalCount","loading","setLoading","getData","Promise","resolve","init","getAxios","params","limit","q","role","parent_id","xid","get","vendors","resp","allparams","total","allvendors","allresp","status","fetchData","result","console","error","actions","includes","push","icon","tooltip","onClick","event","id","handleOnChange","e","target","options","selectedIndex","attributeValue","getAttribute","value","put","res","prevCount","handlePageChange","newPage","handlePageSizeChange","newPageSize","handleSearchChange","title","field","width","render","selected","pageSizeOptions","actionsColumnIndex","searchable","searchText","filteredData","filter","item","name","toLowerCase","mapStateToProps","auth"],"mappings":"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","sourcesContent":["import React, { useState,useEffect } from 'react';\r\nimport JwtService from 'app/services/jwtService';\r\nimport { Grid } from '@material-ui/core';\r\nimport MaterialTable from 'material-table';\r\nimport { useHistory } from 'react-router';\r\nimport FusePageSimple from '@fuse/core/FusePageSimple';\r\n\r\nimport FuseLoading from '@fuse/core/FuseLoading';\r\nimport { connect } from 'react-redux';\r\nimport axios from 'axios';\r\n\r\nfunction Vendors({ user }) {\r\n\r\n\tconst history = useHistory();\r\n  const [selectedOption, setSelectedOption] = useState(''); // Initial selected option\r\n  const [alldata, setAlldata] = useState([]);\r\n  const [data, setData] = useState([]);\r\n  const [page, setPage] = useState([]);\r\n  const [pageSize, setPageSize] = useState(10);\r\n  const [search, setSearch] = useState('');\r\n  const [totalCount, setTotalCount] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n\tfunction getData() {\r\n\t\t\treturn new Promise(async resolve => {\r\n\t\t\t\tJwtService.init();\r\n\t\t\t\tconst axios = JwtService.getAxios();\r\n\t\t\t\tconst params = {\r\n\t\t\t\t\tpage: page,\r\n\t\t\t\t\tlimit: pageSize,\r\n\t\t\t\t\tq: search\r\n\t\t\t\t};\r\n\t\r\n\t\t\t\tif (user.data.role === 'vendor') params.parent_id = user.data.xid;\r\n\t\t\t\telse params.parent_id = 0;\r\n\t\t\t\tconst vendors = await axios.get('/api/admin/vendor', {\r\n\t\t\t\t\tparams\r\n\t\t\t\t});\r\n\t\t\t\tconst resp = vendors.data;\r\n\t\t\t\tif(alldata == ''){\r\n\t\t\t\t\tconst allparams = {\r\n\t\t\t\t\t\tlimit:resp.data.total,\r\n\t\t\t\t\t\tq: '',\r\n\t\t\t\t\t\tparent_id:0\r\n\t\t\t\t\t};\r\n\t\t\t\t\tconst allvendors = await axios.get('/api/admin/vendor?limit='+resp.data.total+'&q=&parent_id=0');\r\n\t\t\t\t\tconst allresp = allvendors.data;\r\n\t\t\t\t\tsetAlldata(allresp.data.data)\r\n\t\t\t\t}\r\n\t\t\t\tif (resp.status) {\r\n\t\t\t\t\tresolve({\r\n\t\t\t\t\t\tdata: resp.data.data, /// your data array\r\n\t\t\t\t\t\tpage: pageSize, // current page number\r\n\t\t\t\t\t\ttotalCount: resp.data.total // total row number\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresolve({\r\n\t\t\t\t\t\tdata: [], /// your data array\r\n\t\t\t\t\t\tpage: 0, // current page number\r\n\t\t\t\t\t\ttotalCount: 0 // total row number\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tconst fetchData = async () => {\r\n\t\t\ttry {\r\n\t\t\t  setLoading(true);\r\n\t\t\t  const result = await getData();\r\n\t\t\t  // console.log(result.totalCount)\r\n\t\t\t  setData(result.data);\r\n\t\t\t  setTotalCount(result.totalCount);\r\n\r\n\t\t\t  // setPage(result.page);\r\n\t\t\t} catch (error) {\r\n\t\t\t  console.error('Error fetching data:', error);\r\n\t\t\t} finally {\r\n\t\t\t  setLoading(false);\r\n\t\t\t}\r\n\t\t  };\r\n  useEffect(() => {\r\n\t  // Define a function to fetch data\r\n\t \r\n\r\n    fetchData(); // Call the fetchData function when selectedOption changes\r\n  }, [selectedOption,page,pageSize]);\r\n  //console.log(data)\r\n\tfunction actions() {\r\n\t\tconst actions = [];\r\n\r\n\t\tif (['admin', 'it', 'creative', 'alliance'].includes(user.data.role)) {\r\n\t\t\tactions.push({\r\n\t\t\t\ticon: 'visibility',\r\n\t\t\t\ttooltip: 'View Vendor',\r\n\t\t\t\tonClick: (event, data) => history.push('/vendor/' + data.id + \"/about\")\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn actions;\r\n\t}\r\n \r\n\tconst handleOnChange = async(e)=> {\r\n\t\tconst selectedOption = e.target.options[e.target.selectedIndex];\r\n\t\tconst attributeValue = selectedOption.getAttribute('row-id');\r\n\t\tconst value = e.target.value\r\n\t\t\r\n\t\tconst res = await axios.put(`/api/admin/vendor/${attributeValue}?status=${value}`)\r\n\t\tif(res.data.status){\r\n\t\t\tsetSelectedOption(prevCount => prevCount + 1);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t  const handlePageChange = (newPage) => {\r\n\t\tsetPage(newPage);\r\n\t  };\r\n\t  \r\n\t  const handlePageSizeChange = (newPageSize) => {\r\n\t\tsetPageSize(newPageSize);\r\n\t\tsetPage(0); // Reset to the first page when changing page size\r\n\t  };\r\n\t  const handleSearchChange = (search) => {\r\n\t\tsetSearch(search);\r\n\t  };\r\n\tif (loading) {\r\n\t\treturn <FuseLoading />;\r\n\t}\r\n\treturn (\r\n\t\t<FusePageSimple\r\n\t\t\tcontent={\r\n\t\t\t\t<Grid container>\r\n\t\t\t\t\t<Grid item md={12}>\r\n\t\t\t\t\t\t\t<MaterialTable\r\n\t\t\t\t\t\t\ttitle=\"Vendors\"\r\n\t\t\t\t\t\t\t// data={{ data: data, totalCount: totalCount, page: page}}\r\n\t\t\t\t\t\t\tdata={data}\r\n\t\t\t\t\t\t\tpage={page}\r\n\t\t\t\t\t\t\ttotalCount={totalCount}\r\n\t\t\t\t\t\t\tcolumns={[\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttitle: 'Name',\r\n\t\t\t\t\t\t\t\t\tfield: 'name',\r\n\t\t\t\t\t\t\t\t\twidth: 30\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttitle: 'Locality',\r\n\t\t\t\t\t\t\t\t\tfield: 'locality',\r\n\t\t\t\t\t\t\t\t\twidth: 30\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttitle: 'City',\r\n\t\t\t\t\t\t\t\t\tfield: 'city.name',\r\n\t\t\t\t\t\t\t\t\twidth: 10\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttitle: 'Status',\r\n\t\t\t\t\t\t\t\t\tfield: 'status',\r\n\t\t\t\t\t\t\t\t\twidth: 10\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttitle: 'Status',\r\n\t\t\t\t\t\t\t\t\tfield: 'name',\r\n\t\t\t\t\t\t\t\t\twidth: 10,\r\n\t\t\t\t\t\t\t\t\trender: (data) => (\r\n\t\t\t\t\t\t\t\t\t\t<select onChange={handleOnChange} id=\"countries\" className=\"bg-gray-50 border border-gray-300 text-gray-900 text-[16px] h-40 rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500\">\r\n\t\t\t\t\t\t\t\t\t\t\t<option selected disabled>Choose a Status</option>\r\n\t\t\t\t\t\t\t\t\t\t\t<option value=\"active\" row-id={data.id} {...(data.status === 'active' ? { selected: true } : {})}>Active</option>\r\n\t\t\t\t\t\t\t\t\t\t\t<option value=\"inactive\" row-id={data.id} {...(data.status === 'inactive' ? { selected: true } : {})} >In-Active</option>\r\n\t\t\t\t\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\tactions={actions()}\r\n\t\t\t\t\t\t\toptions={{\r\n\t\t\t\t\t\t\t\tpageSize: pageSize,\r\n\t\t\t\t\t\t\t\tpageSizeOptions: [10, 20, 50],\r\n\t\t\t\t\t\t\t\tactionsColumnIndex: -1,\r\n\t\t\t\t\t\t\t\tsearchable:true,\r\n\t\t\t\t\t\t\t}}  \r\n\t\t\t\t\t\t\tonChangePage={handlePageChange}\r\n\t\t\t\t\t\t\tonChangeRowsPerPage={handlePageSizeChange}\r\n\t\t\t\t\t\t\t// onSearchChange={handleSearchChange}\r\n\t\t\t\t\t\t\tonSearchChange={(searchText) => {\r\n\t\t\t\t\t\t\t\tconst filteredData = alldata.filter((item) =>\r\n\t\t\t\t\t\t\t\t  item.name.toLowerCase().includes(searchText.toLowerCase())\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\tsetData(filteredData);\r\n\t\t\t\t\t\t\t  }}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t</Grid>\r\n\t\t\t}\r\n\t\t/>\r\n\t);\r\n}\r\nfunction mapStateToProps({ auth }) {\r\n\treturn {\r\n\t\tuser: auth.user\r\n\t};\r\n}\r\n\r\nexport default connect(mapStateToProps)(Vendors);\r\n"]},"metadata":{},"sourceType":"module"}