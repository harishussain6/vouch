{"ast":null,"code":"import _classCallCheck from\"D:\\\\Projects\\\\live\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\Projects\\\\live\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"D:\\\\Projects\\\\live\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"D:\\\\Projects\\\\live\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import FuseSplashScreen from'@fuse/core/FuseSplashScreen';import*as userActions from'app/auth/store/actions';import{UserContext}from'app/context/UserContext';import auth0Service from'app/services/auth0Service';import firebaseService from'app/services/firebaseService';import jwtService from'app/services/jwtService';import*as Actions from'app/store/actions';import React,{Component}from'react';import{connect}from'react-redux';import{bindActionCreators}from'redux';var Auth=/*#__PURE__*/function(_Component){_inherits(Auth,_Component);var _super=_createSuper(Auth);function Auth(){var _this;_classCallCheck(this,Auth);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={waitAuthCheck:true,user:null};_this.jwtCheck=function(){return new Promise(function(resolve){jwtService.on('onAutoLogin',function(){// this.props.showMessage({ message: 'Welcome Back', variant: 'success' });\n/**\n\t\t\t\t * Sign in and retrieve user data from Api\n\t\t\t\t */jwtService.signInWithToken().then(function(user){_this.props.setUserData(user);resolve();// this.props.showMessage({ message: 'Welcome Back', variant: 'success' });\n_this.setState({user:user});}).catch(function(error){_this.props.showMessage({message:error,variant:'error'});resolve();});});jwtService.on('onAutoLogout',function(message){if(message){// this.props.showMessage({ message, variant: 'success' });\n}_this.props.logout();resolve();});jwtService.on('onNoAccessToken',function(){resolve();});jwtService.init();return Promise.resolve();});};_this.auth0Check=function(){return new Promise(function(resolve){auth0Service.init(function(success){if(!success){resolve();}});if(auth0Service.isAuthenticated()){_this.props.showMessage({message:'Logging in with Auth0'});/**\n\t\t\t\t * Retrieve user data from Auth0\n\t\t\t\t */auth0Service.getUserData().then(function(tokenData){_this.props.setUserDataAuth0(tokenData);resolve();_this.props.showMessage({message:'Logged in with Auth0'});});}else{resolve();}return Promise.resolve();});};_this.firebaseCheck=function(){return new Promise(function(resolve){firebaseService.init(function(success){if(!success){resolve();}});firebaseService.onAuthStateChanged(function(authUser){if(authUser){_this.props.showMessage({message:'Logging in with Firebase'});/**\n\t\t\t\t\t * Retrieve user data from Firebase\n\t\t\t\t\t */firebaseService.getUserData(authUser.uid).then(function(user){_this.props.setUserDataFirebase(user,authUser);resolve();_this.props.showMessage({message:'Logged in with Firebase'});},function(error){resolve();});}else{resolve();}});return Promise.resolve();});};return _this;}_createClass(Auth,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;return Promise.all([// Comment the lines which you do not use\n// this.firebaseCheck(),\n// this.auth0Check(),\nthis.jwtCheck()]).then(function(){_this2.setState({waitAuthCheck:false});});}},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/React.createElement(UserContext.Consumer,null,function(_ref){var create=_ref.create;if(_this3.state.user)create(_this3.state.user);return _this3.state.waitAuthCheck?/*#__PURE__*/React.createElement(FuseSplashScreen,null):/*#__PURE__*/React.createElement(React.Fragment,null,_this3.props.children);});}}]);return Auth;}(Component);function mapDispatchToProps(dispatch){return bindActionCreators({logout:userActions.logoutUser,setUserData:userActions.setJWTUserData,setUserDataAuth0:userActions.setUserDataAuth0,setUserDataFirebase:userActions.setUserDataFirebase,showMessage:Actions.showMessage,hideMessage:Actions.hideMessage},dispatch);}export default connect(null,mapDispatchToProps)(Auth);","map":null,"metadata":{},"sourceType":"module"}