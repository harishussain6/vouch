{"ast":null,"code":"import _classCallCheck from\"D:\\\\Projects\\\\live\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\Projects\\\\live\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"D:\\\\Projects\\\\live\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"D:\\\\Projects\\\\live\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import FuseUtils from'@fuse/utils';import AppContext from'app/AppContext';import React,{Component}from'react';import{connect}from'react-redux';import{matchRoutes}from'react-router-config';import{withRouter}from'react-router-dom';var FuseAuthorization=/*#__PURE__*/function(_Component){_inherits(FuseAuthorization,_Component);var _super=_createSuper(FuseAuthorization);function FuseAuthorization(props,context){var _this;_classCallCheck(this,FuseAuthorization);_this=_super.call(this,props);var routes=context.routes;_this.state={accessGranted:true,routes:routes};return _this;}_createClass(FuseAuthorization,[{key:\"componentDidMount\",value:function componentDidMount(){if(!this.state.accessGranted){this.redirectRoute();}}},{key:\"shouldComponentUpdate\",value:function shouldComponentUpdate(nextProps,nextState){return nextState.accessGranted!==this.state.accessGranted;}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){if(!this.state.accessGranted){this.redirectRoute();}}},{key:\"redirectRoute\",value:function redirectRoute(){var _this$props=this.props,location=_this$props.location,userRole=_this$props.userRole,history=_this$props.history;var pathname=location.pathname,state=location.state;var redirectUrl=state&&state.redirectUrl?state.redirectUrl:'/';/*\n        User is guest\n        Redirect to Login Page\n        */if(!userRole||userRole.length===0){history.push({pathname:'/login',state:{redirectUrl:pathname}});}else{/*\n        User is member\n        User must be on unAuthorized page or just logged in\n        Redirect to dashboard or redirectUrl\n        */history.push({pathname:redirectUrl});}}},{key:\"render\",value:function render(){// console.info('Fuse Authorization rendered', accessGranted);\nreturn this.state.accessGranted?/*#__PURE__*/React.createElement(React.Fragment,null,this.props.children):null;}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){var location=props.location,userRole=props.userRole;var pathname=location.pathname;var matched=matchRoutes(state.routes,pathname)[0];return{accessGranted:matched?FuseUtils.hasPermission(matched.route.auth,userRole):true};}}]);return FuseAuthorization;}(Component);function mapStateToProps(_ref){var auth=_ref.auth;return{userRole:auth.user.role};}FuseAuthorization.contextType=AppContext;export default withRouter(connect(mapStateToProps)(FuseAuthorization));","map":null,"metadata":{},"sourceType":"module"}