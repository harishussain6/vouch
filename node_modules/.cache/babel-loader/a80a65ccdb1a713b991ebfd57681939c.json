{"ast":null,"code":"var _jsxFileName = \"D:\\\\Projects\\\\live\\\\src\\\\@fuse\\\\core\\\\FuseLayout\\\\FuseLayout.js\";\nimport { useDeepCompareEffect } from '@fuse/hooks';\nimport FuseLayouts from '@fuse/layouts/FuseLayouts';\nimport _ from '@lodash';\nimport { makeStyles } from '@material-ui/core/styles';\nimport AppContext from 'app/AppContext';\nimport * as Actions from 'app/store/actions';\nimport { generateSettings } from 'app/store/reducers/fuse/settings.reducer';\nimport React, { useContext, useMemo, useCallback, useRef } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { matchRoutes } from 'react-router-config';\nimport { useLocation } from 'react-router-dom';\nimport * as Velocity from 'velocity-animate';\nimport { defaults as Chartjs2Defaults } from 'react-chartjs-2';\nvar useStyles = makeStyles(function (theme) {\n  return {\n    '@global': {\n      'code:not([class*=\"language-\"])': {\n        color: theme.palette.secondary.dark,\n        backgroundColor: theme.palette.type === 'light' ? 'rgba(255, 255, 255, .9)' : 'rgba(0, 0, 0, .9)',\n        padding: '2px 3px',\n        borderRadius: 2,\n        lineHeight: 1.7\n      },\n      'table.simple tbody tr td': {\n        borderColor: theme.palette.divider\n      },\n      'table.simple thead tr th': {\n        borderColor: theme.palette.divider\n      },\n      'a:not([role=button])': {\n        color: theme.palette.secondary.main,\n        textDecoration: 'none',\n        '&:hover': {\n          textDecoration: 'underline'\n        }\n      },\n      '[class^=\"border-\"]': {\n        borderColor: theme.palette.divider\n      },\n      '[class*=\"border-\"]': {\n        borderColor: theme.palette.divider\n      },\n      hr: {\n        borderColor: theme.palette.divider\n      }\n    },\n    root: {\n      backgroundColor: theme.palette.background.default,\n      color: theme.palette.text.primary\n    }\n  };\n});\n\nfunction FuseLayout(props) {\n  var dispatch = useDispatch();\n  var settings = useSelector(function (_ref) {\n    var fuse = _ref.fuse;\n    return fuse.settings.current;\n  });\n  var defaultSettings = useSelector(function (_ref2) {\n    var fuse = _ref2.fuse;\n    return fuse.settings.defaults;\n  });\n  var appContext = useContext(AppContext);\n  var routes = appContext.routes;\n  var classes = useStyles(props);\n  var location = useLocation();\n  var pathname = location.pathname;\n  var matched = matchRoutes(routes, pathname)[0];\n  var newSettings = useRef(null);\n  var shouldAwaitRender = useCallback(function () {\n    var _newSettings;\n    /**\n     * On Path changed\n     */\n    // if (prevPathname !== pathname) {\n\n\n    if (matched && matched.route.settings) {\n      /**\n       * if matched route has settings\n       */\n      var routeSettings = matched.route.settings;\n      _newSettings = generateSettings(defaultSettings, routeSettings);\n    } else if (!_.isEqual(newSettings.current, defaultSettings)) {\n      /**\n       * Reset to default settings on the new path\n       */\n      _newSettings = _.merge({}, defaultSettings);\n    } else {\n      _newSettings = newSettings.current;\n    }\n\n    if (!_.isEqual(newSettings.current, _newSettings)) {\n      newSettings.current = _newSettings;\n    }\n\n    function AnimationToggle(_settings) {\n      if (!_settings.animations) {\n        document.body.classList.add('no-animate');\n        Velocity.mock = true;\n        Chartjs2Defaults.global.animation.duration = 0;\n        Chartjs2Defaults.global.hover.animationDuration = 0;\n      } else {\n        document.body.classList.remove('no-animate');\n        Velocity.mock = false;\n        Chartjs2Defaults.global.animation.duration = 1000;\n        Chartjs2Defaults.global.hover.animationDuration = 400;\n      }\n    }\n\n    AnimationToggle(_newSettings);\n  }, [defaultSettings, matched]);\n  shouldAwaitRender();\n  useDeepCompareEffect(function () {\n    if (!_.isEqual(newSettings.current, settings)) {\n      dispatch(Actions.setSettings(newSettings.current));\n    }\n  }, [dispatch, newSettings.current, settings]); // console.warn('::FuseLayout:: rendered');\n\n  var Layout = useMemo(function () {\n    return FuseLayouts[settings.layout.style];\n  }, [settings.layout.style]);\n  return _.isEqual(newSettings.current, settings) ? /*#__PURE__*/React.createElement(Layout, Object.assign({\n    classes: {\n      root: classes.root\n    }\n  }, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 52\n    }\n  })) : null;\n}\n\nexport default React.memo(FuseLayout);","map":{"version":3,"sources":["D:/Projects/live/src/@fuse/core/FuseLayout/FuseLayout.js"],"names":["useDeepCompareEffect","FuseLayouts","_","makeStyles","AppContext","Actions","generateSettings","React","useContext","useMemo","useCallback","useRef","useDispatch","useSelector","matchRoutes","useLocation","Velocity","defaults","Chartjs2Defaults","useStyles","theme","color","palette","secondary","dark","backgroundColor","type","padding","borderRadius","lineHeight","borderColor","divider","main","textDecoration","hr","root","background","default","text","primary","FuseLayout","props","dispatch","settings","fuse","current","defaultSettings","appContext","routes","classes","location","pathname","matched","newSettings","shouldAwaitRender","_newSettings","route","routeSettings","isEqual","merge","AnimationToggle","_settings","animations","document","body","classList","add","mock","global","animation","duration","hover","animationDuration","remove","setSettings","Layout","layout","style","memo"],"mappings":"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","sourcesContent":["import { useDeepCompareEffect } from '@fuse/hooks';\nimport FuseLayouts from '@fuse/layouts/FuseLayouts';\nimport _ from '@lodash';\nimport { makeStyles } from '@material-ui/core/styles';\nimport AppContext from 'app/AppContext';\nimport * as Actions from 'app/store/actions';\nimport { generateSettings } from 'app/store/reducers/fuse/settings.reducer';\nimport React, { useContext, useMemo, useCallback, useRef } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { matchRoutes } from 'react-router-config';\nimport { useLocation } from 'react-router-dom';\nimport * as Velocity from 'velocity-animate';\nimport { defaults as Chartjs2Defaults } from 'react-chartjs-2';\n\nconst useStyles = makeStyles(theme => ({\n\t'@global': {\n\t\t'code:not([class*=\"language-\"])': {\n\t\t\tcolor: theme.palette.secondary.dark,\n\t\t\tbackgroundColor: theme.palette.type === 'light' ? 'rgba(255, 255, 255, .9)' : 'rgba(0, 0, 0, .9)',\n\t\t\tpadding: '2px 3px',\n\t\t\tborderRadius: 2,\n\t\t\tlineHeight: 1.7\n\t\t},\n\t\t'table.simple tbody tr td': {\n\t\t\tborderColor: theme.palette.divider\n\t\t},\n\t\t'table.simple thead tr th': {\n\t\t\tborderColor: theme.palette.divider\n\t\t},\n\t\t'a:not([role=button])': {\n\t\t\tcolor: theme.palette.secondary.main,\n\t\t\ttextDecoration: 'none',\n\t\t\t'&:hover': {\n\t\t\t\ttextDecoration: 'underline'\n\t\t\t}\n\t\t},\n\t\t'[class^=\"border-\"]': {\n\t\t\tborderColor: theme.palette.divider\n\t\t},\n\t\t'[class*=\"border-\"]': {\n\t\t\tborderColor: theme.palette.divider\n\t\t},\n\t\thr: {\n\t\t\tborderColor: theme.palette.divider\n\t\t}\n\t},\n\troot: {\n\t\tbackgroundColor: theme.palette.background.default,\n\t\tcolor: theme.palette.text.primary\n\t}\n}));\n\nfunction FuseLayout(props) {\n\tconst dispatch = useDispatch();\n\tconst settings = useSelector(({ fuse }) => fuse.settings.current);\n\tconst defaultSettings = useSelector(({ fuse }) => fuse.settings.defaults);\n\n\tconst appContext = useContext(AppContext);\n\tconst { routes } = appContext;\n\tconst classes = useStyles(props);\n\tconst location = useLocation();\n\tconst { pathname } = location;\n\tconst matched = matchRoutes(routes, pathname)[0];\n\tconst newSettings = useRef(null);\n\n\tconst shouldAwaitRender = useCallback(() => {\n\t\tlet _newSettings;\n\t\t/**\n\t\t * On Path changed\n\t\t */\n\t\t// if (prevPathname !== pathname) {\n\t\tif (matched && matched.route.settings) {\n\t\t\t/**\n\t\t\t * if matched route has settings\n\t\t\t */\n\n\t\t\tconst routeSettings = matched.route.settings;\n\n\t\t\t_newSettings = generateSettings(defaultSettings, routeSettings);\n\t\t} else if (!_.isEqual(newSettings.current, defaultSettings)) {\n\t\t\t/**\n\t\t\t * Reset to default settings on the new path\n\t\t\t */\n\t\t\t_newSettings = _.merge({}, defaultSettings);\n\t\t} else {\n\t\t\t_newSettings = newSettings.current;\n\t\t}\n\n\t\tif (!_.isEqual(newSettings.current, _newSettings)) {\n\t\t\tnewSettings.current = _newSettings;\n\t\t}\n\n\t\tfunction AnimationToggle(_settings) {\n\t\t\tif (!_settings.animations) {\n\t\t\t\tdocument.body.classList.add('no-animate');\n\t\t\t\tVelocity.mock = true;\n\t\t\t\tChartjs2Defaults.global.animation.duration = 0;\n\t\t\t\tChartjs2Defaults.global.hover.animationDuration = 0;\n\t\t\t} else {\n\t\t\t\tdocument.body.classList.remove('no-animate');\n\t\t\t\tVelocity.mock = false;\n\t\t\t\tChartjs2Defaults.global.animation.duration = 1000;\n\t\t\t\tChartjs2Defaults.global.hover.animationDuration = 400;\n\t\t\t}\n\t\t}\n\n\t\tAnimationToggle(_newSettings);\n\t}, [defaultSettings, matched]);\n\n\tshouldAwaitRender();\n\n\tuseDeepCompareEffect(() => {\n\t\tif (!_.isEqual(newSettings.current, settings)) {\n\t\t\tdispatch(Actions.setSettings(newSettings.current));\n\t\t}\n\t}, [dispatch, newSettings.current, settings]);\n\n\t// console.warn('::FuseLayout:: rendered');\n\n\tconst Layout = useMemo(() => FuseLayouts[settings.layout.style], [settings.layout.style]);\n\n\treturn _.isEqual(newSettings.current, settings) ? <Layout classes={{ root: classes.root }} {...props} /> : null;\n}\n\nexport default React.memo(FuseLayout);\n"]},"metadata":{},"sourceType":"module"}